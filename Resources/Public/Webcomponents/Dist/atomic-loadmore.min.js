export default class AtomicLoadmore extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.callback=this.getAttribute("callback"),this.headers=this.attributes.headers?this.attributes.headers.value:{"Content-Type":"application/x-www-form-urlencoded"}}connectedCallback(){this.render(),this._activateButton()}get method(){return this.attributes.timeout?this.attributes.timeout.value:100}get mode(){return this.attributes.mode?this.attributes.mode.value:"cors"}get method(){return this.attributes.method?this.attributes.method.value:"POST"}get form(){if(this.hasAttribute("getFormData")){return this.hasAttribute("formSelector")?document.querySelector(this.getAttribute("formSelector")):this.closest("form")}}get formData(){return this.form?new FormData(this.form):null}get url(){return this.attributes.url?this.attributes.url.value:""}get target(){if(this.hasAttribute("target")){let t=this.getAttribute("target");return(t=document.querySelector(t))||this}}get loader(){return this.shadowRoot.querySelector(".loader")}_activateButton(){this.shadowRoot.querySelector("#link").addEventListener("click",t=>{t.stopPropagation(),t.preventDefault(),this.load(t=>{var e=(new DOMParser).parseFromString(t,"text/html").querySelector("body").innerHTML;this._addContent(e),this.callback&&this._customCallback(e)})})}_addContent(t){var e=new DOMParser;this.loadedContent=e.parseFromString(t,"text/html").querySelector("body").innerHTML,this.remove()}disconnectedCallback(){this.target.innerHTML+=this.loadedContent}load(t){this.url&&(this.loader.classList.remove("hidden"),fetch(this.url,{method:this.method,mode:this.mode,body:this.formData?this.formData:null}).then(t=>t.text()).then(e=>{t(e)}).catch(function(t){console.warn("Something went wrong.",t)}))}_customCallback(data){if(!this.callback)return;const func=eval(this.callback);func(data)}render(){this.shadowRoot.innerHTML=`\n            <style>\n                :host{\n                    display:block;\n                    position: relative;\n                    \n                }\n                .hidden{\n                    display:none !important;\n                }\n                .loader {\n                  display: block;\n                  margin: auto;\n                  margin-top: var(--base-loadermore--loader-margin, 20px);\n                  width: calc(var(--base-loadermore--loader-size, 40px) * 1.2);\n                  height: calc(var(--base-loadermore--loader-size, 40px) * 1.2);\n                }\n                .loader:after {\n                  content: " ";\n                  display: block;\n\n                  left: 50%;\n                  top: calc(var(--base-loadermore--loader-size, 40px) * -10px);\n                  transform: translateX(-50%);\n                  width: var(--base-loadermore--loader-size, 40px);\n                  height: var(--base-loadermore--loader-size, 40px);\n      \n                  border-radius: 50%;\n                  opacity: var(--base-loadermore--loader-opacity, 0.5);\n                  border: 6px solid var(--base-loadermore--loader-color, black);\n                  border-color: var(--base-loadermore--loader-color, black) transparent var(--base-loadermore--loader-color, black) transparent;\n                  animation: loader 1.2s linear infinite;\n                }\n                @keyframes loader {\n                  0% {\n                    transform: rotate(0deg);\n                  }\n                  100% {\n                    transform: rotate(360deg);\n                  }\n                }\n            </style>\n            <slot name="dataSlot"></slot>   \n            <div class="">\n               <a href="${this.url}" id="link" part="link">\n                <slot></slot>            \n               </a>\n            </div>\n            <div class="loader hidden"></div> \n        `}}void 0===customElements.get("atomic-loadmore")&&window.customElements.define("atomic-loadmore",AtomicLoadmore);